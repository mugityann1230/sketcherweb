# Web 2D-CAD → Mesh → FEM 出力：要件定義（1枚）

## 0. 目的（1文）
ブラウザ上で2D形状を作成し、メッシュを生成して、FEMソルバに入力できる形式で出力する。

## 1. 想定ユーザー / 利用シーン
- 自作FEMや既存ソルバ（例：CalculiX / Code_Aster など）に解析用メッシュを渡したい人
- 2Dの簡易形状（板・穴あき板・ブラケット等）を素早く作って解析したい

## 2. 成果物（スコープ）
- Web 2Dスケッチ（線分/円/円弧）
- 閉曲線から「面（外周＋穴）」生成
- メッシュ生成（バックエンドでGmsh）
- 出力：Gmsh .msh（v4）＋（任意で）FEM入力ファイル最小1種類

## 3. MVPでできること（Must）
### 3.1 作図/編集
- パン/ズーム/グリッド表示
- スナップ：グリッド、端点、中点
- 図形：線分(Line)、円(Circle)、円弧(Arc)
- 編集：選択/移動/削除
- Undo/Redo
- 保存/読み込み：JSON

### 3.2 面（Region）生成
- 閉ループ抽出（外周/内周=穴）
- 妥当性チェック：未閉/自己交差/重複辺はエラー表示

### 3.3 メッシュ生成
- Region → Gmsh入力変換 → .msh生成
- メッシュサイズ指定：global size（1つ）＋（任意で）境界細分化1つ
- 生成結果のダウンロード

## 4. 受け入れ条件（Acceptance）
- 例題A：穴あき板（外周矩形＋円穴）を作り、.mshを生成できる
- 例題B：ドーナツ（外周円＋内周円）を作り、.mshを生成できる
- 例題C：未閉曲線/自己交差は、メッシュ生成前に明確にエラー表示される

## 5. 非目標（Won't / Later）
- 3D CAD、ソリッド、押し出し
- DXF/DWGの完全互換
- スプライン/自由曲線
- 高度な製図（寸法線、注記、図枠）
- 高度な拘束ソルバ（まずは後回し）

## 6. 技術方針（おすすめ）
- Frontend：React + TypeScript（Canvas描画）
- Backend：Python FastAPI（Gmsh CLI呼び出し）
- 内部データ：
  - Sketch（編集用）：Point/Line/Arc + constraints(後回し)
  - Region（解析用）：outer loop + inner loops
- 出力：Gmsh .msh v4（固定）

## 7. 品質/非機能
- 操作レスポンス：基本操作は100ms以内目標
- エラーは「どの辺が原因か」分かるメッセージを出す
- 例題の自動テスト（最低：幾何/ループ抽出/Region妥当性）
