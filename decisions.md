# sketcherweb 設計判断ログ（decisions）

ここは「いつ / なにを / なぜ決めたか」を残す場所。
仕様や実装がブレたときに、戻って判断理由を確認できるようにする。

---

## 書き方テンプレ
### YYYY-MM-DD: [DEC-XXX] タイトル
- 決定：何を決めたか（1〜3行）
- 理由：なぜそうしたか（箇条書き）
- 影響：どこに影響するか（frontend/backend/data/tests など）
- 代替案：検討した案（あれば）
- ステータス：採用 / 撤回 / 保留

---

## 決定事項

### 2025-12-27: [DEC-001] メッシュ生成はバックエンドでGmshを使う
- 決定：メッシュ生成はブラウザ内ではなく、バックエンドでGmsh CLIを実行する
- 理由：
  - 安定したメッシュ生成・出力形式が最短で手に入る
  - “最小構成（最初に動く到達点）”を早く通すのが優先
- 影響：backend（/mesh, gmsh_runner）、docs/architecture、dev_setup
- 代替案：WASMでメッシャを内包（難易度高、後回し）
- ステータス：採用

### 2025-12-27: [DEC-002] 出力はGmsh .msh v4に固定する（当面）
- 決定：メッシュ出力は `.msh v4` を正とする
- 理由：
  - 仕様を固定して初期のブレを減らす
  - 後からv2や他形式を追加すればよい
- 影響：backend出力、フロントDL、将来のFEM入力変換
- 代替案：v2（互換は高いが、まずv4でOK）
- ステータス：採用

### 2025-12-27: [DEC-003] 内部表現は Sketch と Region を分離する
- 決定：編集用（Sketch）と解析用（Region）を別データとして定義する
- 理由：
  - UIの自由度と解析の厳密さを分離できる
  - 検証（validate）ポイントが明確になる
- 影響：データモデル、幾何処理、API入力
- 代替案：1データで全て（後で破綻しやすい）
- ステータス：採用

### 2025-12-27: [DEC-004] 不正形状は“MVPでは厳しめに弾く”
- 決定：自己交差や重複などは、補正せずエラーとして返す（当面）
- 理由：
  - 自動補正は複雑でバグ源になりやすい
  - まず“確実に通る”ラインを作る
- 影響：validate/エラーUI、テスト
- 代替案：補正（スナップ補正、ブーリアン等）を先にやる
- ステータス：採用
